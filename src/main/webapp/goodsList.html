<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>商品页</title>
    <meta charset="GB18030">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta name="description" content="">
    <meta name="author" content="">

    <link rel="stylesheet" href="bootstrap/css/bootstrap.min.css">
    <link rel="stylesheet" href="css/font-awesome.min.css">
    <link rel="stylesheet" href="css/main.css">
    <link rel="stylesheet" type="text/css" href="css/webbase.css"/>
    <link rel="stylesheet" type="text/css" href="css/pages-item.css"/>
    <link rel="stylesheet" type="text/css" href="css/pages-zoom.css"/>
    <link rel="stylesheet" type="text/css" href="css/widget-cartPanelView.css"/>
    <script type="text/javascript" src="plugins/angularjs/angular.min.js"></script>
    <script type="text/javascript" src="js/base.js"></script>
    <script type="text/javascript" src="js/controller/itemController.js"></script>
    <script src="jquery/jquery-2.1.1.min.js"></script>
    <script src="bootstrap/js/bootstrap.min.js"></script>
    <script src="script/docs.min.js"></script>
    <style>
        .tree li {
            list-style-type: none;
            cursor: pointer;
        }

        table tbody tr:nth-child(odd) {
            background: #F4F4F4;
        }

        table tbody td:nth-child(even) {
            color: #C00;
        }
    </style>
</head>
<body>
<!--页面顶部 开始-->
<div class="header">
    <!--页面顶部 开始-->
    <div id="nav-bottom">
        <!--顶部-->
        <div class="nav-top">
            <div class="top">
                <div class="py-container">
                    <div class="shortcut">
                        <div id="checkIfLogin">
                            <ul class="fl">
                                <li class="f-item">品优购欢迎您！</li>
                                <li class="f-item">请<a href="login.html" target="_blank">登录</a>　<span><a
                                        href="register.html" target="_blank">免费注册&ensp;&ensp;</a></span></li>
                                <!--<li class="f-item"><span><a onclick="logOut()" target="_blank">退出</a></span></li>-->
                            </ul>
                        </div>
                        <ul class="fr">
                            <a href="home-index.html" class="f-item">我的订单</a>
                            <li class="f-item space"></li>
                            <li class="f-item"><a href="dataRevise.html" target="_blank">我的品优购</a></li>
                            <li class="f-item space"></li>
                            <li class="f-item">品优购会员</li>
                            <li class="f-item space"></li>
                            <li class="f-item">企业采购</li>
                            <li class="f-item space"></li>
                            <li class="f-item">关注品优购</li>
                            <li class="f-item space"></li>
                            <li class="f-item" id="service">
                                <span>客户服务</span>
                                <ul class="service">
                                    <li><a href="cooperation.html" target="_blank">合作招商</a></li>
                                    <li><a href="shoplogin.html" target="_blank">商家后台</a></li>
                                    <li><a href="cooperation.html" target="_blank">合作招商</a></li>
                                    <li><a href="#">商家后台</a></li>
                                </ul>
                            </li>
                            <li class="f-item space"></li>
                            <li class="f-item">网站导航</li>
                        </ul>
                    </div>
                </div>
            </div>

            <!--头部-->
            <div class="header">
                <div class="py-container">
                    <div class="yui3-g Logo">
                        <div class="yui3-u Left logoArea">
                            <a class="logo-bd" title="品优购" href="goodsList.html" target="_blank"></a>
                        </div>
                        <div class="yui3-u Center searchArea">
                            <div class="search">
                                <form action="" class="sui-form form-inline">
                                    <!--searchAutoComplete-->
                                    <div class="input-append">
                                        <input type="text" id="autocomplete" type="text"
                                               class="input-error input-xxlarge"/>
                                        <button class="sui-btn btn-xlarge btn-danger" type="button">搜索</button>
                                    </div>
                                </form>
                            </div>
                            <div class="hotwords">
                                <ul>
                                    <li class="f-item">品优购首发</li>
                                    <li class="f-item">亿元优惠</li>
                                    <li class="f-item">9.9元团购</li>
                                    <li class="f-item">每满99减30</li>
                                    <li class="f-item">亿元优惠</li>
                                    <li class="f-item">9.9元团购</li>
                                    <li class="f-item">办公用品</li>

                                </ul>
                            </div>
                        </div>
                        <div class="yui3-u Right shopArea">
                            <div class="fr shopcar">
                                <div class="show-shopcar" id="shopcar">
                                    <span class="car"></span>
                                    <a class="sui-btn btn-default btn-xlarge" href="cart1.html" target="_blank">
                                        <span>我的购物车</span>
                                        <i class="shopnum">0</i>
                                    </a>
                                    <div class="clearfix shopcarlist" id="shopcarlist" style="display:none">
                                        <p>"啊哦，你的购物车还没有商品哦！"</p>
                                        <p>"啊哦，你的购物车还没有商品哦！"</p>
                                    </div>
                                </div>
                                <div class="show-shopcar" id="shopcar1">
                                    <span class="car"></span>
                                    <a class="sui-btn btn-default btn-xlarge" href="favourite.html" target="_blank">
                                        <span>我的收藏夹</span>
                                        <i class="shopnum">0</i>
                                    </a>
                                    <div class="clearfix shopcarlist" id="shopcarlist1" style="display:none">
                                        <p>"啊哦，你的购物车还没有商品哦！"</p>
                                        <p>"啊哦，你的购物车还没有商品哦！"</p>
                                    </div>
                                </div>
                                <div class="show-shopcar" id="shopcar2">
                                    <span class="car"></span>
                                    <a class="sui-btn btn-default btn-xlarge" href="records.html" target="_blank">
                                        <span>我的足迹</span>
                                        <i class="shopnum">0</i>
                                    </a>
                                    <div class="clearfix shopcarlist" id="shopcarlist2" style="display:none">
                                        <p>"啊哦，你的购物车还没有商品哦！"</p>
                                        <p>"啊哦，你的购物车还没有商品哦！"</p>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>

                    <div class="yui3-g NavList">
                        <div class="yui3-u Left all-sort">
                            <h4>全部商品分类</h4>
                        </div>
                        <div class="yui3-u Center navArea">
                            <ul class="nav">
                                <li class="f-item">服装城</li>
                                <li class="f-item">美妆馆</li>
                                <li class="f-item">品优超市</li>
                                <li class="f-item">全球购</li>
                                <li class="f-item">闪购</li>
                                <li class="f-item">团购</li>
                                <li class="f-item">有趣</li>
                            </ul>
                        </div>
                        <div class="yui3-u Right"></div>
                    </div>
                </div>
            </div>
        </div>
    </div>
    <!--页面顶部 结束-->
</div>
<!--<script src="js/public_share_code.js"></script>-->
<!--页面顶部 结束-->
<form class="form-inline" role="form" style="float:left;">
    <div class="form-group has-feedback">
        <div class="input-group">
            <div class="input-group-addon"></div>
            <!--<input class="form-control has-success" type="text" placeholder="请输入商品名" id="goodsName">-->
            <!--<input class="form-control has-success" type="text" placeholder="请输入价格" id="costPrice1">-->
            <div class="gettype" style="float: left;margin-left: auto">
                类别：<select onchange="selectGoodsByType()" id="selOp">
                <option selected>全部</option>
                <!--<option value="0">未审核</option>-->
                <!--<option value="1">正在申请</option>-->
                <!--<option value="2">审核通过</option>-->
                <!--<option value="3">审核不合格</option>-->
            </select>
            </div>
            <div class="check" style="float: left; margin-left: 160px">
                <input class="form-control has-success" type="text" placeholder="请输入商品名" id="SearchbyGoodsName">&ensp;&ensp;&ensp;
            </div>
            <div class="check" style="float: left">
                <input class="form-control has-success" type="text" placeholder="请输入最低价格" id="SearchbyGoodsPrice1">___
            </div>
            <div class="check" style="float: left">
                <input class="form-control has-success" type="text" placeholder="请输入最高价格" id="SearchbyGoodsPrice2">&ensp;&ensp;&ensp;&ensp;
            </div>
            <!--<div>-->
            <!--<button type="button" class="btn btn-primary" style="float:right;"-->
            <!--onclick="window.location.href='addGoods.html'"><i class="glyphicon glyphicon-plus"></i> 新增-->
            <!--</button>-->
            <!--</div>-->
            <button type="button" class="btn btn-warning" onclick="searchGoods()"><i
                    class="glyphicon glyphicon-search"></i> 查询
            </button>
        </div>
    </div>
    <!--<div class="crumb-wrap">-->
    <!--<ul class="sui-breadcrumb">-->
    <!--<li>-->
    <!--<a href="#">男装</a>-->
    <!--</li>-->
    <!--<li>-->
    <!--<a href="#">女装</a>-->
    <!--</li>-->
    <!--<li>-->
    <!--<a href="#">鞋子</a>-->
    <!--</li>-->
    <!--<li>-->
    <!--<a href="#">箱包</a>-->
    <!--</li>-->
    <!--</ul>-->
    <!--</div>-->
</form>
<br>
<hr style="clear:both;">
<div class="table-responsive">
    <table class="table  table-bordered" id="dataTable">
        <thead>
        <tr>
            <th>goodsId</th>
            <th>商品名</th>
            <th>商品价格</th>
            <th>商品品牌</th>
            <th>商品描述</th>
            <th>商品图片</th>
            <th>库存</th>
            <th width="100">操作</th>
        </tr>
        </thead>
        <tbody>
        <tr>
            <td>1</td>
            <td><input type="checkbox"></td>
            <td>Lorem</td>
            <td>ipsum</td>
            <td>dolor</td>
            <td>dolor</td>
            <td>dolor</td>

            <td>
                <button type="button" class="btn btn-success btn-xs" onclick="removerGoods()"><i
                        class=" glyphicon glyphicon-check"></i></button>
                <button type="button" class="btn btn-primary btn-xs"><i class=" glyphicon glyphicon-pencil"></i>
                </button>
                <button type="button" class="btn btn-danger btn-xs"><i class=" glyphicon glyphicon-remove"></i></button>
                <div>
                    <a class='sui-btn btn-block btn-buy' href='buy-item.html' target='_blank'></a>
                </div>
                <div>
                    <button>加入收藏</button>
                </div>
                <div>
                    <button>加入收藏</button>
                </div>
            </td>
        </tr>

        </tbody>
        <tfoot>
        <tr>
            <td colspan="10" align="center">
                <ul class="pagination">
                    <li class="disabled"><a href="#">上一页</a></li>
                    <li class="active"><a href="#">1 <span class="sr-only">(current)</span></a></li>
                    <li><a href="#">2</a></li>
                    <li><a href="#">3</a></li>
                    <li><a href="#">下一页</a></li>
                </ul>
            </td>
        </tr>
        </tfoot>
    </table>
</div>
<!--页面底部 开始-->
<!--<div class="footerpage"></div>-->
<div class="footer">
    <div class="clearfix footer">
        <div class="py-container">
            <div class="footlink">
                <div class="Mod-service">
                    <ul class="Mod-Service-list">
                        <li class="grid-service-item intro  intro1">

                            <i class="serivce-item fl"></i>
                            <div class="service-text">
                                <h4>正品保障</h4>
                                <p>正品保障，提供发票</p>
                            </div>

                        </li>
                        <li class="grid-service-item  intro intro2">

                            <i class="serivce-item fl"></i>
                            <div class="service-text">
                                <h4>正品保障</h4>
                                <p>正品保障，提供发票</p>
                            </div>

                        </li>
                        <li class="grid-service-item intro  intro3">

                            <i class="serivce-item fl"></i>
                            <div class="service-text">
                                <h4>正品保障</h4>
                                <p>正品保障，提供发票</p>
                            </div>

                        </li>
                        <li class="grid-service-item  intro intro4">

                            <i class="serivce-item fl"></i>
                            <div class="service-text">
                                <h4>正品保障</h4>
                                <p>正品保障，提供发票</p>
                            </div>

                        </li>
                        <li class="grid-service-item intro intro5">

                            <i class="serivce-item fl"></i>
                            <div class="service-text">
                                <h4>正品保障</h4>
                                <p>正品保障，提供发票</p>
                            </div>

                        </li>
                    </ul>
                </div>

                <div class="Mod-copyright">
                    <ul class="helpLink">
                        <li>关于我们<span class="space"></span></li>
                        <li>联系我们<span class="space"></span></li>
                        <li>关于我们<span class="space"></span></li>
                        <li>商家入驻<span class="space"></span></li>
                        <li>营销中心<span class="space"></span></li>
                        <li>友情链接<span class="space"></span></li>
                        <li>关于我们<span class="space"></span></li>
                        <li>营销中心<span class="space"></span></li>
                        <li>友情链接<span class="space"></span></li>
                        <li>关于我们</li>
                    </ul>
                    <p>地址：北京市昌平区建材城西路金燕龙办公楼一层 邮编：100096 电话：400-618-4000 传真：010-82935100</p>
                    <p>京ICP备08001421号京公网安备110108007702</p>
                </div>
            </div>
        </div>
    </div>
</div>
<!--页面底部  结束 -->
<!--<script>-->
<!--$(function () {-->
<!--$(".headerpage").load("/headerAndFooter/header.html");-->
<!--$(".footerpage").load("/headerAndFooter/footer.html");-->
<!--});-->
<!--</script>-->
<script>
    // 判断用户是否登录
    console.log("判断是否登录!");

    $.ajax({

        url: "http://localhost:8080//checkIfLogin",
        success: function (result) {
            console.log("success检测用户是否登录");

            if (result) {
                $("#checkIfLogin").html("");
                $(result).each(function (index, item) {
                    var trStr = "<ul class=\"fl\">";
                    trStr += "<li class=\"f-item\">品优购欢迎您！</li>";
                    trStr += "<li class=\"f-item\">" + item.username + "</li>&ensp;&ensp;";
                    trStr += "<li class=\"f-item\"><span><a onclick=\"logOut()\" target=\"_blank\">退出</a></span></li>";
                    trStr += "</ul>";
                    $("#checkIfLogin").append(trStr);
                    console.log("用户已登陆");
                    console.log(item);
                    sessionStorage.setItem("userid", item.userid);

                });
            } else {
                console.log("用户未登录")
            }

        },
        error: function (e) {
            console.log(e);
            console.log(e.status);
            console.log(e.responseText);
        }
    })

</script>
<script src="jquery/jquery-2.1.1.min.js"></script>
<script src="bootstrap/js/bootstrap.min.js"></script>
<script src="script/docs.min.js"></script>
<script type="text/javascript" src="js/model/cartModel.js"></script>
<script type="text/javascript" src="js/plugins/jquery.easing/jquery.easing.min.js"></script>
<script type="text/javascript" src="js/plugins/sui/sui.min.js"></script>
<script type="text/javascript" src="js/plugins/jquery.jqzoom/jquery.jqzoom.js"></script>
<script type="text/javascript" src="js/plugins/jquery.jqzoom/zoom.js"></script>

<script>
    /**
     * 获取下拉框显示的类别
     */
    function initSelect() {
        $.ajax({
            //请求方式GET/POST
            type: "GET",
            //请求的媒体类型
            contentType: "application/json;charset=UTF-8",
            //接受数据类型
            dataType: "json",
            async: false,
            //请求地址
            url: "http://localhost:8080//listAllTypes",
            //数据，json字符串
            //请求成功
            success: function (data) {
                //$("#selOp").html("");
                console.log(data);
                var i;
                for (i in data) {
                    $("#selOp").append("<option value='" + data[i] + "'>" + data[i] + "</option>");
                }
            },
            error: function (e) {
                console.error(e);
                console.log(e.status);
                console.log(e.responseText);
            }
        });

        initPage();
    }

    initSelect();
   
   
    //清空table
    //初始化页面
    function initPage() {
        var pageNum = window.location.search.split("=")[1];
        var requestURL = "listAll";
        if (pageNum != null) {
            requestURL += "?pageNum=" + pageNum;
        }
        //1.从后台的listAllGoodsInfo接口获取数据
        $.ajax({
            //请求方式GET/POST
            type: "POST",
            //请求的媒体类型
            contentType: "application/json;charset=UTF-8",
            //接受数据类型
            dataType: "json",
            //请求地址
            url: requestURL,
            //数据，json字符串
            //请求成功
            data: JSON.stringify({
                "goodsName": $("#SearchbyGoodsName").val().trim(),
                "goodsPrice1": $("#SearchbyGoodsPrice1").val().trim(),
                "goodsPrice2": $("#SearchbyGoodsPrice2").val().trim()
            }),
            success: function (result) {
                console.log(result);
                $("#dataTable tbody").html("");
                $(result.list).each(function (index, item) {
                    var trStr = "<tr>";
                    trStr += "<td >" + item.goodsId + "</td>";
                    trStr += "<td >" + item.goodsName + "</td>";
                    trStr += "<td >" + item.goodsPrice + "</td>";
                    trStr += "<td>" + item.goodsBrand + "</td>";
                    trStr += "<td >" + item.goodsContent + "</td>";
                    trStr+= "<td>"+"<img src="+item.goodsPic+" width=100px height=100px>"+"</td>";
                    trStr += "<td>" + item.goodsStock + "</td>";
                    trStr += "<td>";
                    trStr += "<button type=\"button\" class='btn btn-success btn-xs'><i class=' glyphicon glyphicon-check' onclick='addCart(" + item.goodsId + ")'></i></button>&nbsp;"
                    trStr += "<button type=\"button\" class='btn btn-primary btn-xs'><i class=' glyphicon glyphicon-pencil' onclick='toProductDetails(" + item.goodsId + ")'></i></button>&nbsp;"
                    // trStr += "<button type=\"button\" class='btn btn-danger btn-xs'><i class=' glyphicon glyphicon-remove' onclick='removeGoods(" + item.goodsId + ")'></i></button>"
                    trStr += "<div>";
                    // trStr += "<a class='sui-btn btn-block btn-buy' href='buy-item.html' target='_blank'>";
                    // trStr += "立即购买";
                    // trStr += "</a>";
                    trStr += "</div>";
                    trStr += "<div><button onclick='addFavourite(" + item.goodsId + ")'>加入收藏</button></div>";
                    // <div>
                    // <a class='sui-btn btn-block btn-buy' href='buy-item.html' target='_blank'></a>
                    // </div>
                    trStr += "</td>";
                    trStr += "</tr>";
                    $("#dataTable").append(trStr);
                });
                var splitePageStr = "<li class=\"disabled\"><a href=\"#\">上一页</a></li>";
                for (var i = 1; i <= result.pages; i++) {
                    splitePageStr += "<li><a href=\"goodsList.html?pageNum=" + i + "\">" + i + "</a></li>";
                }
                splitePageStr += "<li><a href=\"#\">下一页</a></li>";
                $(".pagination").html("");
                $(".pagination").append(splitePageStr);
            }
            ,
            //请求失败，包含具体的错误信息
            error: function (e) {
                console.error(e);
                console.log(e.status);
                console.log(e.responseText);
            }
        })
        ;
    }

    // 单个移除商品
    function removeGoods(id) {
        //ajax--》调用方法
        $.ajax({
            //请求方式GET/POST
            type: "GET",
            //请求的媒体类型
            contentType: "application/json;charset=UTF-8",
            //接受数据类型
            dataType: "json",
            //请求地址
            url: "http://localhost:8080//removeGoodsInfoById?id=" + id,
            //数据，json字符串
            //请求成功
            success: function (result) {
                if (result) {
                    alert("删除成功");
                    initPage();
                } else {
                    alert("删除失败")
                }
            },
            error: function (e) {
                console.log(e);
            }
        })
    }

    // 商品详情
    // 将商品id发到后台--我的足迹并判断是否登录
    //提示登录,登录了就保存,不登录不保存
    function toProductDetails(goodsid) {
        //window.location.href = "product_details.html?id="+goodsid;
        // 先判断是否登录
        var userid = sessionStorage.getItem("userid");
       
        sessionStorage.setItem("goodsid",goodsid);
        console.log("登录用户id为" + userid);
        console.log("商品id为" + goodsid);
        //window.location.href = "product_details.html";
        if (userid != null && userid != 0 && goodsid != null && goodsid != 0) {
            $.ajax({
                //请求方式GET/POST
                type: "POST",
                //请求的媒体类型
                contentType: "application/json;charset=UTF-8",
                //接受数据类型
                dataType: "json",
                data: JSON.stringify({
                    "userid": userid,
                    "goodsid": goodsid
                }),
                //请求地址
                url: "http://localhost:8080//addToRecords",
                success: function (result) {
                    console.log("保存id到我的足迹完成");
                    if (result) {
                        //alert(goodsid)
                        window.location.href = "product_details.html?id="+goodsid;
                    } else {
                    }
                },
                error: function (e) {
                    console.log(e);
                    console.log(e.status);
                    console.log(e.responseText);
                }
            });
        } else {
            //提示登录 跳转到登录页
            var b = confirm("请先登录!");
            if (b == true) {
                window.location.href = "login.html";
            } else if (b == false) {
                window.location.href = "product_details.html";
            }
        }

    }
    // 加入收藏夹并判断是否登录
    function addFavourite(goodsid) {
        // 先判断是否登录
        var userid = sessionStorage.getItem("userid");
        console.log("登录用户id为" + userid);
        console.log("商品id为" + goodsid);
        if (userid != null && userid != 0 && goodsid != null && goodsid != 0) {
            $.ajax({
                //请求方式GET/POST
                type: "POST",
                //请求的媒体类型
                contentType: "application/json;charset=UTF-8",
                //接受数据类型
                dataType: "json",
                data: JSON.stringify({
                    "userid": userid,
                    "goodsid": goodsid
                }),
                //请求地址
                url: "http://localhost:8080//addToMyFavourite",
                success: function (result) {
                    console.log(result);
                    if (result) {
                        alert("已收藏");
                    } else {
                        alert("加入收藏夹失败");
                    }
                },
                error: function (e) {
                    console.log(e);
                    console.log(e.status);
                    console.log(e.responseText);
                }
            })
        } else {
            //提示登录 跳转到登录页
            var b = confirm("请先登录!");
            if (b == true) {
                window.location.href = "login.html";
            }
        }
    }
    // 加入购物车并判断是否登录
    function addCart(goodsid) {
        // 先判断是否登录
        var userid = sessionStorage.getItem("userid");
        console.log("登录用户id为" + userid);
        //alert(userid);
        //alert(goodsid);
        if (userid != null) {
            $.ajax({
                //请求方式GET/POST
                type: "POST",
                //请求的媒体类型
                contentType: "application/json;charset=UTF-8",
                //接受数据类型
                dataType: "json",
                //请求地址
                url: "http://localhost:8080//addCart",

                data: JSON.stringify({
                    "userid": userid,
                    "goodsid": goodsid
                }),
                success: function (result) {
                    console.log(result);
                    if (result) {
                        alert("加入购物车")
                    } else {
                        alert("加入购物车失败")
                    }
                },
                error: function (e) {
                    console.log(e);
                    console.log(e.status);
                    console.log(e.responseText);
                }
            })
        } else {
            //提示登录 跳转到登录页
            var b = confirm("请先登录!");
            if (b == true) {
                window.location.href = "login.html";
            }
        }

    }

    /**
     * 下拉框更改类别获得商品
     */
    function selectGoodsByType() {
        var typeName = $("#selOp option:selected").val();
        console.log(typeName);
        if (typeName == "全部") {
            initPage();
        } else {
            $.ajax({
                //请求方式GET/POST
                type: "GET",
                //请求的媒体类型
                contentType: "application/json;charset=UTF-8",
                //接受数据类型
                dataType: "json",
                //请求地址
                url: "selectGoodsByType?typeName=" + typeName,
                //数据，json字符串
                //请求成功
                success: function (result) {
                    $("#dataTable tbody").html("");
                    console.log(result);
                    $(result).each(function (index, item) {
                        console.log(item);
                        var trStr = "<tr>";
                        trStr += "<td >" + item.goodsId + "</td>";
                        trStr += "<td >" + item.goodsName + "</td>";
                        trStr += "<td >" + item.goodsPrice + "</td>";
                        trStr += "<td>" + item.goodsBrand + "</td>";
                        trStr += "<td >" + item.goodsContent + "</td>";
                        trStr+= "<td>"+"<img src="+item.goodsPic+" width=100px height=100px>"+"</td>";
                        trStr += "<td>" + item.goodsStock + "</td>";
                        trStr += "<td>";
                        trStr += "<button type=\"button\" class='btn btn-success btn-xs'><i class=' glyphicon glyphicon-check' onclick='addCart(" + item.goodsId + ")'></i></button>&nbsp;"
                        trStr += "<button type=\"button\" class='btn btn-primary btn-xs'><i class=' glyphicon glyphicon-pencil' onclick='toProductDetails(" + item.goodsId + ")'></i></button>&nbsp;"
                        trStr += "<button type=\"button\" class='btn btn-danger btn-xs'><i class=' glyphicon glyphicon-remove' onclick='removeGoods(" + item.goodsId + ")'></i></button>"

                        trStr += "<div>";
                        // trStr += "<a class='sui-btn btn-block btn-buy' href='buy-item.html' target='_blank'>";
                        // trStr += "立即购买";
                        // trStr += "</a>";
                        trStr += "</div>";
                        // <div>
                        // <a class='sui-btn btn-block btn-buy' href='buy-item.html' target='_blank'></a>
                        // </div>
                        trStr += "</td>";
                        trStr += "</tr>";
                        $("#dataTable").append(trStr);
                    });
                },
                //请求失败，包含具体的错误信息
                error: function (e) {
                    console.error(e);
                    console.log(e.status);
                    console.log(e.responseText);
                }
            });
        }
    }


    // 根据条件查询商品
    function searchGoods() {
        console.log("查询开始");
        var name = $("#SearchbyGoodsName").val();
        var price1 = $("#SearchbyGoodsPrice1").val();
        var price2 = $("#SearchbyGoodsPrice2").val();
        if ((name == null || name == undefined || name == "") && (price1 == null && price1 && undefined && price1 == "") && (price2 == null && price2 == undefined && price2 == "")) {
            location.reload(true);
        } else {
            $.ajax({
                type: "POST",
                contentType: "application/json;charset=UTF-8",
                dataType: "json",
                url: "http://localhost:8080//searchGoods",
                data: JSON.stringify({
                    "goodsName": $("#SearchbyGoodsName").val().trim(),
                    "goodsPrice1": $("#SearchbyGoodsPrice1").val().trim(),
                    "goodsPrice2": $("#SearchbyGoodsPrice2").val().trim()
                }),
                success: function (result) {
                    console.log(result);
                    $("#dataTable tbody").html("");
                    $(result).each(function (index, item) {
                        var trStr = "<tr>";
                        trStr += "<td >" + item.goodsId + "</td>";
                        trStr += "<td >" + item.goodsName + "</td>";
                        trStr += "<td >" + item.goodsPrice + "</td>";
                        trStr += "<td>" + item.goodsBrand + "</td>";
                        trStr += "<td >" + item.goodsContent + "</td>";
                        trStr+= "<td>"+"<img src="+item.goodPpic+" width=100px height=100px>"+"</td>";
                        trStr += "<td>" + item.goodsStock + "</td>";
                        trStr += "<td>";
                        trStr += "<button type=\"button\" class='btn btn-success btn-xs'><i class=' glyphicon glyphicon-check' onclick='addCart(" + item.goodsId + ")'></i></button>&nbsp;"
                        trStr += "<button type=\"button\" class='btn btn-primary btn-xs'><i class=' glyphicon glyphicon-pencil' onclick='toProductDetails(" + item.goodsId + ")'></i></button>&nbsp;"
                        trStr += "<button type=\"button\" class='btn btn-danger btn-xs'><i class=' glyphicon glyphicon-remove' onclick='removeGoods(" + item.goodsId + ")'></i></button>"

                        trStr += "<div>";
                        // trStr += "<a class='sui-btn btn-block btn-buy' href='buy-item.html' target='_blank'>";
                        // trStr += "立即购买";
                        // trStr += "</a>";
                        trStr += "</div>";
                        // <div>
                        // <a class='sui-btn btn-block btn-buy' href='buy-item.html' target='_blank'></a>
                        // </div>
                        trStr += "</td>";
                        trStr += "</tr>";
                        $("#dataTable").append(trStr);
                    });

                },
                error: function (e) {
                    console.log(e);
                    console.log(e.status);
                    console.log(e.responseText);
                }
            })
        }

    }

   
</script>
<script>
    //我的购物车按钮
    // 判断是否登录
    function toCartHtml() {
        //var id = sessionStorage.getItem("goodsStorage");
        var userid = sessionStorage.getItem("userid");
        console.log("登录的用户id为" + userid);
        if (userid != null&&userid!=0) {
            window.location.href = "cart.html";
        } else {
            //提示登录 跳转到登录页
            var b = confirm("请先登录!");
            if (b == true) {
                window.location.href = "login.html";
            }
        }
    }
</script>
<script>
    //注销退出
    function logOut() {
        $.ajax({
            //请求方式GET/POST
            type: "GET",
            //请求的媒体类型
            contentType: "application/json;charset=UTF-8",
            //接受数据类型
            dataType: "json",
            //请求地址
            url: "http://localhost:8080//logOut",
            success: function (result) {
                console.log("执行logOut ajax");
                if (result) {
                    alert("已退出");
                    window.location.href = "login.html"
                } else {
                    alert("退出失败");
                }
            },
            error: function (e) {
                console.log(e);
                console.log(e.status);
                console.log(e.responseText);
            }
        })
    }
</script>

</body>
</html>