<!DOCTYPE html>
<html>

<head>
	<meta charset="UTF-8">
	<meta http-equiv="X-UA-Compatible" content="IE=9; IE=8; IE=7; IE=EDGE">
	<meta http-equiv="X-UA-Compatible" content="IE=EmulateIE7" />
	<title>结算页</title>

    <link rel="stylesheet" type="text/css" href="css/webbase.css" />
    <link rel="stylesheet" type="text/css" href="css/pages-getOrderInfo.css" />
</head>

<body>
	<!--head-->
	<div class="top">
		<div class="py-container">
			<div class="shortcut">
				<ul class="fl">
					<a href="goodsList.html" class="f-item">品优购欢迎您！</a>
					<a href="login.html" class="f-item">请登录　<span><a href="#">免费注册</a></span></a>
				</ul>
				<ul class="fr">
					<a href="home-index.html" class="f-item">我的订单</a>
					<li class="f-item space"></li>
					<li class="f-item">我的品优购</li>
					<li class="f-item space"></li>
					<li class="f-item">品优购会员</li>
					<li class="f-item space"></li>
					<li class="f-item">企业采购</li>
					<li class="f-item space"></li>
					<li class="f-item">关注品优购</li>
					<li class="f-item space"></li>
					<li class="f-item">客户服务</li>
					<li class="f-item space"></li>
					<li class="f-item">网站导航</li>
				</ul>
			</div>
		</div>
	</div>
	<div class="cart py-container">
		<!--logoArea-->
		<div class="logoArea">
			<div class="fl logo"><span class="title">结算页</span></div>
			<div class="fr search">
				<form class="sui-form form-inline">
					<div class="input-append">
						<input type="text" type="text" class="input-error input-xxlarge" placeholder="品优购自营" />
						<button class="sui-btn btn-xlarge btn-danger" type="button">搜索</button>
					</div>
				</form>
			</div>
		</div>
		<!--主内容-->
		<div class="checkout py-container">
			<div class="checkout-tit">
				<h4 class="tit-txt">填写并核对订单信息</h4>
			</div>
			<div class="checkout-steps">
				<!--收件人信息-->
				<div class="step-tit">
					<h5>收货地址<span><a data-toggle="modal" data-target=".edit" data-keyboard="false" class="newadd"></a></span></h5>
				</div>
				<div class="step-cont">
					<div class="addressInfo">
						<ul class="unstyled">
						<li>请设置默认收货地址：<a href="home-setting-address.html" class="btn">设置</a></li>

						</ul>
<!--						<ul class="addr-detail">-->
<!--							<li class="addr-item">-->
<!--							-->
<!--							  <div>-->
<!--								<div class="con name selected"><a href="javascript:;" >张默<span title="点击取消选择">&nbsp;</a></div>-->
<!--								<div class="con address">张默 北京市海淀区三环内 中关村软件园9号楼 <span>159****3201</span>-->
<!--									<span class="base">默认地址</span>-->
<!--									<span class="edittext"><a data-toggle="modal" data-target=".edit" data-keyboard="false" >编辑</a>&nbsp;&nbsp;<a href="javascript:;">删除</a></span>-->
<!--								</div>-->
<!--								<div class="clearfix"></div>-->
<!--							  </div>-->
<!--							  <div>-->
<!--								<div class="con name"><a href="javascript:;">李煜<span title="点击取消选择">&nbsp;</a></div>-->
<!--								<div class="con address">李煜 北京市海淀区三环内 中关村软件园8号楼 <span>187****4201</span>-->
<!--								<span class="edittext"><a data-toggle="modal" data-target=".edit" data-keyboard="false" >编辑</a>&nbsp;&nbsp;<a href="javascript:;">删除</a></span>-->
<!--								</div>-->
<!--								<div class="clearfix"></div>-->
<!--							  </div>-->
<!--							  -->
<!--							  <div>-->
<!--								<div class="con name"><a href="javascript:;">王希<span title="点击取消选择">&nbsp;</a></div>-->
<!--								<div class="con address">王希 北京市海淀区三环内 中关村软件园6号楼  <span>156****5681</span>-->
<!--								<span class="edittext"><a data-toggle="modal" data-target=".edit" data-keyboard="false" >编辑</a>&nbsp;&nbsp;<a href="javascript:;">删除</a></span>-->
<!--								</div>-->
<!--								<div class="clearfix"></div>-->
<!--							  </div>-->
<!--							</li>-->
<!--							-->
<!--							-->
<!--						</ul>-->
						<!--添加地址-->
<!--                          <div  tabindex="-1" role="dialog" data-hasfoot="false" class="sui-modal hide fade edit">-->
<!--						  <div class="modal-dialog">-->
<!--						    <div class="modal-content">-->
<!--						      <div class="modal-header">-->
<!--						        <button type="button" data-dismiss="modal" aria-hidden="true" class="sui-close">×</button>-->
<!--						        <h4 id="myModalLabel" class="modal-title">添加收货地址</h4>-->
<!--						      </div>-->
<!--						      <div class="modal-body">-->
<!--						      	<form action="" class="sui-form form-horizontal">-->
<!--						      		 <div class="control-group">-->
<!--									    <label class="control-label">收货人：</label>-->
<!--									    <div class="controls">-->
<!--									      <input type="text" class="input-medium">-->
<!--									    </div>-->
<!--									  </div>-->
<!--									   -->
<!--									   <div class="control-group">-->
<!--									    <label class="control-label">详细地址：</label>-->
<!--									    <div class="controls">-->
<!--									      <input type="text" class="input-large">-->
<!--									    </div>-->
<!--									  </div>-->
<!--									   <div class="control-group">-->
<!--									    <label class="control-label">联系电话：</label>-->
<!--									    <div class="controls">-->
<!--									      <input type="text" class="input-medium">-->
<!--									    </div>-->
<!--									  </div>-->
<!--									   <div class="control-group">-->
<!--									    <label class="control-label">邮箱：</label>-->
<!--									    <div class="controls">-->
<!--									      <input type="text" class="input-medium">-->
<!--									    </div>-->
<!--									  </div>-->
<!--									   <div class="control-group">-->
<!--									    <label class="control-label">地址别名：</label>-->
<!--									    <div class="controls">-->
<!--									      <input type="text" class="input-medium">-->
<!--									    </div>-->
<!--									    <div class="othername">-->
<!--									    	建议填写常用地址：<a href="#" class="sui-btn btn-default">家里</a>　<a href="#" class="sui-btn btn-default">父母家</a>　<a href="#" class="sui-btn btn-default">公司</a>-->
<!--									    </div>-->
<!--									  </div>-->
<!--									  -->
<!--						      	</form>-->
<!--						      	-->
<!--						      	-->
<!--						      </div>-->
<!--						      <div class="modal-footer">-->
<!--						        <button type="button" data-ok="modal" class="sui-btn btn-primary btn-large">确定</button>-->
<!--						        <button type="button" data-dismiss="modal" class="sui-btn btn-default btn-large">取消</button>-->
<!--						      </div>-->
<!--						    </div>-->
<!--						  </div>-->
<!--						</div>-->
						 <!--确认地址-->
					</div>
					<div class="hr"></div>
					
				</div>
				<div class="hr"></div>
				<!--支付和送货-->
				<div class="payshipInfo">
					<div class="step-tit">
						<h5>支付方式</h5>
					</div>
					<div class="step-cont">
						<ul class="payType">
							<li class="selected">支付宝付款<span title="点击取消选择"></span></li>
							<li>货到付款<span title="点击取消选择"></span></li>
						</ul>
					</div>
					<div class="hr"></div>
					<div class="step-tit">
						<h5>送货清单</h5>
					</div>
					<table class="sui-table table-bordered order-datatable" id="dataTable">
						<tbody>

						</tbody>
					</table>
					<div class="hr"></div>
				</div>
				<div class="linkInfo">
					<div class="step-tit">
						<h5>发票信息</h5>
					</div>
					<div class="step-cont">
						<span>普通发票（电子）</span>
						<span>个人</span>
						<span>明细</span>
					</div>
				</div>
				<div class="cardInfo">
					<div class="step-tit">
						<h5>使用优惠/抵用</h5>
					</div>
				</div>
			</div>
		</div>
		<table class="sui-table table-bordered order-datatable" id="dataTable1">
			<tbody>

			</tbody>
		</table>
<!--		<div class="order-summary">-->
<!--			<div class="static fr">-->
<!--				<div class="list">-->
<!--					<span><i class="number">1</i>件商品，总商品金额</span>-->
<!--					<em class="allprice">¥5399.00</em>-->
<!--				</div>-->
<!--				<div class="list">-->
<!--					<span>返现：</span>-->
<!--					<em class="money">0.00</em>-->
<!--				</div>-->
<!--				<div class="list">-->
<!--					<span>运费：</span>-->
<!--					<em class="transport">0.00</em>-->
<!--				</div>-->
<!--			</div>-->
<!--		</div>-->
<!--		<div class="list" id="flg" style="float: right;">-->
<!--								-->
<!--		</div>-->

		<div class="clearfix trade">
			<div class="fc-price" id="flg2"><span class="price"></span></div>
			<div class="fc-receiverInfo" id="shipaddress"></div>
		</div>

		<form name=alipayment action="/goodsPayController" method=post target="_blank">
			<input type="hidden" id="location" name="location">
			<input type="hidden" id="totalPrice" name="totalPrice">
			<input type="hidden" id="hotelName" name="hotelName">　
			<input type="hidden" id="orderId" name="orderId">
			<!--<div class="submit-pay">
				<input type="submit" value="立即支付" class="btn">
				
			</div>-->
			<div class="submit">
			<!--<a class="sui-btn btn-danger btn-xlarge" >提交订单</a>-->
				<input type="submit" value="立即支付" class="btn" id="addorder()">
			</div>
		</form>
	</div>

<script type="text/javascript" src="js/plugins/jquery/jquery.min.js"></script>
<script type="text/javascript" src="js/plugins/jquery.easing/jquery.easing.min.js"></script>
<script type="text/javascript" src="js/plugins/sui/sui.min.js"></script>
<script type="text/javascript" src="components/ui-modules/nav/nav-portal-top.js"></script>
<script type="text/javascript" src="js/pages/getOrderInfo.js"></script>

	<script>
		// 通过userid拿出结算后的订单
		//function initpage(){
			$.ajax({
				//请求方式GET/POST
				type: "POST",
				//请求的媒体类型
				contentType: "application/json;charset=UTF-8",
				//接受数据类型
				dataType: "json",
				//请求地址
				url: "http://localhost:8080//selectBuyOrderInfo",

				success: function (result) {
					console.log(result.orderno);
					$("#orderId").val(result.orderno);
					$("#totalPrice").val(result.sumprice);
					$("#hotelName").val("wfl");
					$("#location").val("wfl");
					// $("#dataTable tbody").html("");
					// $("#dataTable1 tbody").html("");
					// $("#flg2").html("");
					//2.将数据填充到table中
					// var flg1=0;
					// var flg2=0;
					// var flg3;
					// var flg4;
					// $(result).each(function (index, item) {
					// 	//console.log(item);
					//     flg1+=item.goodscount;
					// 	flg2+=item.sumprice;
					// 	flg3=item.orderno;
					// 	flg4=item.orderinfoid;
					//	
					// /*	$("orderId").val(flg3);
					// 	$("totalPrice").val(flg2);
					// 	$("hotelName").val("wfl");
					// 	$("location").val("wfl");*/
					//
					// 	console.log(flg1);
					// 	console.log(flg2);
					// 	var trStr ="<div class=\"step-cont\">";
					// 	trStr +="<ul class=\"send-detail\">";
					// 	trStr +="<li>";
					// 	trStr +="<div class=\"sendGoods\">";
					// 	trStr +="<ul class=\"yui3-g\">";
					// 	trStr +="<li class=\"yui3-u-1-6\">";
					// 	trStr +="<span><img width='80' src=\""+item.goodspic+"\"/></span>";
					// 	trStr +="</li>";
					// 	trStr +="<li class=\"yui3-u-7-12\">";
					// 	trStr +="<div class=\"desc\">"+item.goodsname+","+item.goodscontent+"</div>";
					// 	trStr +="<div class=\"seven\" >七天无理由退货</div>";
					// 	trStr +="</li>";
					// 	trStr +="<li class=\"yui3-u-1-12\">";
					// 	trStr +="<div class=\"price\">￥"+item.goodsprice+"</div>";
					// 	trStr +="</li>";
					// 	trStr +="<li class=\"yui3-u-1-12\">";
					// 	trStr +="<div class=\"num\">"+item.goodscount+"</div>";
					// 	trStr +="</li>";
					// 	trStr +="<li class=\"yui3-u-1-12\">";
					// 	trStr +="<div class=\"exit\">有货</div>";
					// 	trStr +="</li>";
					// 	trStr +="</ul>";
					// 	trStr +="</div>";
					// 	trStr +="</li>";
					// 	trStr +="<li></li>";
					// 	trStr +="<li></li>";
					// 	trStr +="</ul>";
					// 	trStr +="</div>";
					// 	$("#dataTable").append(trStr);
					//
					// })

					var trStr1 = "<div class=\"order-summary\">";
					trStr1 += "<div class=\"static fr\">";
					trStr1 += "<div class=\"list\">";
					trStr1 = "<span><i class=\"number\">" + flg1 + "</i>件商品，</span>";
					trStr1 += "<em class=\"allprice\">总商品金额¥:" + flg2 + "</em>";
					trStr1 += "</div>";
					trStr1 += "<div class=\"list\">";
					trStr1 += "<span>返现:</span>";
					trStr1 += "<em class=\"money\">0.00</em>";
					trStr1 += "</div>";
					trStr1 += "<div class=\"list\">";
					trStr1 += "<span>运费:</span>";
					trStr1 += "<em class=\"transport\">0.00</em>";
					trStr1 += "</div>";
					trStr1 += "</div>";
					trStr1 += "</div>";
					$("#dataTable1").append(trStr1);

					var trStr2 = "<div class=\"fc-price\" id=\"flg2\">";
					trStr2 += "应付金额:";
					trStr2 += "<span class=\"price\" id='orderprice'>¥:" + flg2 + "</span> <br>";
					trStr2 += "<span class=\"orderno\" id='orderinfoid'>订单编号:" + flg4 + "</span>	<br>";
					trStr2 += "<span class=\"orderno\" id='orderno'>订单号:" + flg3 + "</span>	";
					trStr2 += "</div>";
					$("#flg2").append(trStr2);

				},
				//请求失败，包含具体的错误信息
				error: function (e) {
					console.error(e);
					console.log(e.status);
					console.log(e.responseText);
				}
			})

		function address() {
			$.ajax({
				//请求方式GET/POST
				type: "POST",
				//请求的媒体类型
				contentType: "application/json;charset=UTF-8",

				//接受数据类型
				dataType: "json",
				//请求地址
				url: "http://localhost:8080//selectshipaddress",

				//请求成功
				success: function (result) {
					$("#shipaddress").html("");

					//2.将数据填充到table中
					$(result).each(function (index, item) {
						var trStr5 ="<div class=\"fc-receiverInfo\" id=\"shipaddress\">";
						trStr5 +="寄送至:"+item.province+","+item.city+", "+item.addressdetail+" 收货人："+item.shipname+"  联系电话："+item.shipphone+"  邮箱："+item.email+" ";
						//trStr5 +=" <p>收货地址："+item.province+","+item.city+", "+item.addressdetail+" </p>";
						// trStr5 +=" <p>收货人："+item.shipname+"  </p>";
						// trStr5 +=" <p>联系电话："+item.shipphone+"  </p>";
						// trStr5 +=" <p>邮箱："+item.email+"  </p>";
						trStr5 +="</div>";
						$("#shipaddress").append(trStr5);
					});
				},
				//请求失败，包含具体的错误信息
				error: function (e) {
					console.error(e);
					console.log(e.status);
					console.log(e.responseText);
				},
			});
		}
		address();

			function addorder() {
				var orderno = document.getElementById("orderno").innerHTML.split(":")[1];
				var orderprice = document.getElementById("orderprice").innerHTML.split(":")[1];
				alert(orderno+""+orderprice);
				$.ajax({
					//请求方式GET/POST
					type: "POST",
					//请求的媒体类型
					contentType: "application/json;charset=UTF-8",

					//接受数据类型
					dataType: "json",
					//请求地址
					url: "http://localhost:8080//goodsPayController",
					data:JSON.stringify({
						"orderno":orderno,
						"sumprice":orderprice
					}),

					success: function (result) {
						console.log(result);
						
					},
					error: function (e) {
						console.error(e);
						console.log(e.status);
						console.log(e.responseText);
					},
				})
			}


			
	</script>
</body>
</html>